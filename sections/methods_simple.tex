
%% Consider a network with nodes $x_1,\dots,x_{N}$. Let there be a connection from node $x_i$ to $x_j$ with probability $P_{ij}$. Typically, . However, it is highly unlikely that all nodes are connected with the same probability. 

%% Thus let the $P_{ij}$ be identically distributed continuous random variables with values in $[0,1]$. We write the of probability density function of the $P_{ij}$ as $f_{P_{ij}}$.


%% We're discussing now a network model in which node-to-node connection probabilities are randomly distributed. One might think for example of a network in which connection probability decreases with distance.

%% Remembering the notation from above, we write
%% \[
%% P(X_{ij}=1) = P_{ij}
%% \]
%% where $P=P_{ij}$ are identically distributed continuous random variables with values in $[0,1]$. We write the of probability density function of the $P_{ij}$ as $f_{P_{ij}}$.


The emergence of non-random connectivity patterns can be modeled by assigning each connection in a random graph a separate probability to exist. In such a model some connections are more likely to be realized than others, allowing for the encoding of patterns within the specific probabilities of each connection. In the limiting case each connection either exists or is absent with certainity ($P=1$) presenting a blueprint for the network architecture.

To analyze the effect of non-random patterns within a network, specifically on the statistics of bidirectionally connected pairs found in the network, we consider a random graph model of $N$ neurons in which a connection from node $i$ to node $j$ exists with probability $P_{ij}$. Here the $(P_{ij})_{i,j=1,\dots,N}$ are identically distributed random variables in $[0,1]$, yielding a probability of connection for each ordered pair of nodes in the graph.  

Given the $(P_{ij})_{i,j=1,\dots,N}$, what is then the probability in this model for a random node to have a projection to another random node in the network? We can compute this overall connection probability $\mu$ easily as the expected value of $P_{ij}$,
\begin{align}
\mu = \E(P_{ij}).
\end{align}
%
%% Here, we are interested in the probability $P_{\mathbf{bidir}}$ of finding In a random pair of neurons, the probability  to find a bidirectional connection is the expected value of the product of $P=P_{ij}$ and $Q=P_{ji}$. With their respective density functions $f_P$, $f_Q$ and their joint probability density function $f_{PQ}$ we have
%
%
In this work we are interested in the probability $P_{\mathbf{bidir}}$ of a bidirectional connection to exist in a random pair of neurons. We determine $P_{\mathbf{bidir}}$ as the expected value of the product of $P_{ij}$ and $P_{ji}$,
%
\begin{align}
P_{\mathbf{bidir}} = \E(P_{ij} P_{ji}).
\end{align}
%

The relative occurrence $\varrho$ of such reciprocally connected pairs compares $P_{\mathbf{bidir}}$ with the occurrence of bidirectional pairs in an Erd\H{o}s-R\'{e}nyi graph, in which each unidirectional connection is equally likely to occur with probability $\mu$ \cite{Gilbert1959, Erdos1959}. The chance of a bidirectional connection in such a random graph is simply $\mu^2$ and we obtain the relative occurrence as the quotient
%% To answer the question if this probability is deviates from the proabibility than we would expect . The probability of a bidirectional in this standard random graph is $\mu$. We can the overrepresentation of as the quotient of $
\begin{align}
\varrho = \frac{P_{\mathbf{bidir}}}{\mu^2} = \frac{\E(P_{ij}P_{ji})}{{\E\left(P_{ij}\right)}^2}.
\end{align}

Experimental studies in local cortical circuits of rodents have repeatedly reported a relative occurrence of bidirectional connections $\varrho > 1$ \cite{Markram1997, Song2005, Perin2011}. To understand in which cases such an overrepresentations occurs, we consider two cases. In the first case, assume that the random variables $P_{ij}$ and $P_{ji}$ are independent. Then
\begin{align}
\E(P_{ij} P_{ji}) = \E(P_{ij})\,\E(P_{ji}) = \E(P_{ij})^2,
\end{align}
and we expect to observe no overrepresentation of reciprocal connections, $\varrho = 1$. However, if in the second case connection probabilities are symmetric in pairs, $P_{ij} = P_{ji}$, then 
\begin{align}
P_{\mathbf{bidir}} = \E(P_{ij}^2).
\end{align}
%
The relative occurrence of reciprocal connections then becomes
\begin{align}
\varrho = \frac{\E(P_{ij}^2)}{{\E\left(P_{ij}\right)}^2}.
\end{align}
and we immediately see that any distribution of $P_{ij}$ with a nonvanishing variance will lead to a relative occurrence that deviates from the Erd\H{o}s-R\'{e}nyi graph, $\varrho \neq 1$. Moreover, since $x \mapsto x^2$ is a strictly convex function, Jensen's inequality yields
\begin{align}
\E(P_{ij}^2) \geq \E(P_{ij})^2,
\end{align}
where equality holds if and only if $P_{ij}$ is constant, ensuring an overrepresentation of bidirectional connections $\varrho > 1$ for any non-degenerate distribution of connection probabilities in the network. In other words, in a network model where some pairs are more likely connected than others, the count of expected reciprocally connected pairs is strictly underestimated by the statistics of an Erd\H{o}s-R\'{e}nyi graph with same overall connection probability $\E(P_{ij}) = \mu$.



%% Finally we can write the expected overrepresentation as
%% \[
%% \varrho = \frac{\E(P_{ij}^2)}{{\E\left(P_{ij}\right)}^2}.
%% \]


