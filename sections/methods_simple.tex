
%% Consider a network with nodes $x_1,\dots,x_{N}$. Let there be a connection from node $x_i$ to $x_j$ with probability $P_{ij}$. Typically, . However, it is highly unlikely that all nodes are connected with the same probability. 

%% Thus let the $P_{ij}$ be identically distributed continuous random variables with values in $[0,1]$. We write the of probability density function of the $P_{ij}$ as $f_{P_{ij}}$.


%% We're discussing now a network model in which node-to-node connection probabilities are randomly distributed. One might think for example of a network in which connection probability decreases with distance.

%% Remembering the notation from above, we write
%% \[
%% P(X_{ij}=1) = P_{ij}
%% \]
%% where $P=P_{ij}$ are identically distributed continuous random variables with values in $[0,1]$. We write the of probability density function of the $P_{ij}$ as $f_{P_{ij}}$.


Non-random network connectivity in a random graph can be modeled by assigning each connection a separate probability to exist. Some connections are more likely to be realized in the network, some less. In the limiting case a blue print. Here we assume a network with 

The overall connection probability $\mu$ is the probability a connection from one random node to another random node, In the given network we can compute $\mu$ as the expected value of $P_{ij}$,
\begin{align}
\mu = \E(P_{ij}).
\end{align}

%% Here, we are interested in the probability $P_{\mathbf{bidir}}$ of finding In a random pair of neurons, the probability  to find a bidirectional connection is the expected value of the product of $P=P_{ij}$ and $Q=P_{ji}$. With their respective density functions $f_P$, $f_Q$ and their joint probability density function $f_{PQ}$ we have


Here, we are interested in the probability $P_{\mathbf{bidir}}$ of a bidirectional connection in a random pair of neurons. We determine $P_{\mathbf{bidir}}$ as the expected value product of the product of $P_{ij}$ and $P_{ji}$,
%
\begin{align}
P_{\mathbf{bidir}} = \E(P_{ij} P_{ji}).
\end{align}
%

The relative occurrence of reciprocally connected pairs $\sigma$ compares $P_{\mathbf{bidir}}$ with the occurrence of bidirectional pairs in an Erd\H{o}s-R\'{e}nyi graph, in which each unidirectional connection is equally likely to occur with probability $\mu$ \cite{Gilbert1959, Erdos1959}. The chance of a bidirectional connection in such graph is then simply $\mu^2$ and we obtain the relative occurrence as the quotient
%% To answer the question if this probability is deviates from the proabibility than we would expect . The probability of a bidirectional in this standard random graph is $\mu$. We can the overrepresentation of as the quotient of $
\begin{align}
\sigma = \frac{P_{\mathbf{bidir}}}{\mu^2} = \frac{\E(P_{ij}P_{ji})}{{\E\left(P_{ij}\right)}^2}.
\end{align}


%% Again, the \enquote{expected} probability to find a bidirectional connection would be given as
%% \[
%% \mu^2 = \E(P_{ij})^2.
%% \]
%% However, the chance to have an bidirectional connection in a pair is the product of the two connection probabilities of the two nodes. In our model, these probabilities $P=P_{ij}$ and $Q=P_{ji}$ stem from a random distribution, given by their density functions $f_P = f_Q$
%% %
%% \begin{align*}
%% \E(PQ) & = \int_0^1 \int_0^1 pq f_{PQ}(p,q) \,dp\,dq = \int_0^1 \int_0^1 pq f_{Q|P}(q|p) f_{P}(p) \,dp\,dq.
%% \end{align*}

If the random variables $P_{ij}$ and $P_{ji}$ are independent then $f_{Q|P}(q|p) = f_Q(q)$ and thus
\begin{align}
\E(P_{ij} P_{ji}) = \E(P_{ij})\,\E(P_{ji}) = \E(P_{ij})^2
\end{align}
Thus in this case, we expect to observe no overrepresentation of reciprocal connections, $\sigma = 1$.

However, if connection probabilities are symmetric, i.e. from $P = p$ immediately follows $Q=p$,
\[
f_{Q|P}(q|p) = \delta(q-p),
\]
then we obtain
%
\begin{align*}
\E(PQ) & = \int_0^1 \int_0^1 pq f_{Q}(q) f_{P}(p) \,dp\,dq = \int_0^1 p^2  f_{P}(p) \,dp =  \E(P_{ij}^2).
\end{align*}
%
From Jensen's inequality, since $x \mapsto x^2$ is a strictly convex function, we have
%
\[
\E(PQ) = \E(P_{ij}^2) \geq \E(P_{ij})^2,
\]
where equality holds if and only if $P_{ij}$ is constant. In other words, any distribution of connection probabilities, where some pairs are more likely connected than others, lead to an underestimation of the reciprocally connected pair count using the overall connection probability $\E(P_{ij}) = \mu$.

In the symmetric case we have,
\[
\sigma = \frac{\E(P_{ij}^2)}{{\E\left(P_{ij}\right)}^2}.
\]

%% Finally we can write the expected overrepresentation as
%% \[
%% \sigma = \frac{\E(P_{ij}^2)}{{\E\left(P_{ij}\right)}^2}.
%% \]


